group: mart
table: customer_analytics
description: "Customer analytics mart combining customer, order, and payment data"
columns:
  - name: customer_key
    description: "Unique identifier for each customer"
    depends_on: [stg.customers.customer_key]
  - name: full_name
    description: "Customer's complete name (first + last)"
    depends_on: [stg.customers.full_name]
  - name: email_address
    description: "Customer's primary email address"
    depends_on: [stg.customers.email_address]
  - name: country_code
    description: "ISO country code for customer location"
    depends_on: [stg.customers.country_code]
  - name: registration_date
    description: "Date when customer first registered"
    depends_on: [stg.customers.registration_date]
  - name: days_since_registration
    description: "Number of days since customer registration"
    depends_on: [stg.customers.days_since_registration]
  - name: customer_lifetime_orders
    description: "Total number of orders placed by customer"
    depends_on: [stg.customers.customer_lifetime_orders]
  - name: customer_lifetime_value
    description: "Total monetary value of all customer purchases"
    depends_on: [stg.customers.customer_lifetime_value]
  - name: is_high_value_customer
    description: "Flag indicating if customer is high-value (CLV > threshold)"
    depends_on: [stg.customers.is_high_value_customer]
  - name: is_active_customer
    description: "Flag indicating if customer has made a purchase recently"
    depends_on: [stg.customers.is_active_customer]
  - name: latest_order_date
    description: "Date of customer's most recent order"
    depends_on: [stg.orders_enriched.order_date, stg.orders_enriched.customer_key]
  - name: average_order_value
    description: "Average monetary value per order for this customer"
    depends_on: [stg.orders_enriched.total_order_amount, stg.orders_enriched.customer_key]
  - name: total_products_purchased
    description: "Total quantity of products purchased by customer"
    depends_on: [stg.order_items_with_metrics.total_quantity, stg.orders_enriched.customer_key]
