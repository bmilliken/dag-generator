group: stg
table: product_analytics
description: "Product performance metrics with cross-category analysis"
columns:
  - name: product_key
    description: "Unique identifier for each product"
    depends_on: [src.products.product_id]
  - name: product_name
    description: "Display name of the product"
    depends_on: [src.products.product_name]
  - name: category_name
    description: "Name of the product category"
    depends_on: [src.products.category_id, src.categories.category_id, src.categories.category_name]
  - name: list_price
    description: "Standard retail price of the product"
    depends_on: [src.products.list_price]
  - name: cost_price
    description: "Internal cost price for margin calculations"
    depends_on: [src.products.cost_price]
  - name: profit_margin
    description: "Calculated profit margin as percentage ((list_price - cost_price) / list_price)"
    depends_on: [src.products.list_price, src.products.cost_price]
  - name: total_units_sold
    description: "Total quantity of this product sold across all orders"
    depends_on: [src.products.product_id, src.order_items.product_id, src.order_items.quantity]
  - name: total_revenue_generated
    description: "Total revenue generated by this product across all sales"
    depends_on: [src.products.product_id, src.order_items.product_id, src.order_items.quantity, src.order_items.unit_price]
  - name: average_selling_price
    description: "Average price at which this product has been sold (may differ from list price)"
    depends_on: [src.products.product_id, src.order_items.product_id, src.order_items.unit_price, src.order_items.quantity]
  - name: unique_customers_count
    description: "Number of distinct customers who have purchased this product"
    depends_on: [src.products.product_id, src.order_items.product_id, src.order_items.order_id, src.orders.order_id, src.orders.user_id]
  - name: orders_containing_product
    description: "Number of distinct orders that include this product"
    depends_on: [src.products.product_id, src.order_items.product_id, src.order_items.order_id]
  - name: category_revenue_rank
    description: "Rank of this product by revenue within its category"
    depends_on: [src.products.product_id, src.products.category_id, src.order_items.product_id, src.order_items.quantity, src.order_items.unit_price]
