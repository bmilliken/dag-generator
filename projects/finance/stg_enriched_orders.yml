group: stg
table: enriched_orders
columns:
  - name: order_id
    depends_on: ["src.orders.order_id"]
  - name: user_id
    depends_on: ["src.orders.user_id"]
  - name: enriched_order_id
    description: "A unique identifier for each enriched order, combining order_id and user_id."
  - name: order_date
    depends_on: ["src.orders.order_date"]
  - name: item_count
    depends_on: ["src.order_items.quantity"]  # Generated field: sum of quantities per order
  - name: order_revenue
    depends_on: ["src.order_items.quantity", "src.order_items.unit_price"]  # Generated field: sum(qty * price)
    description: "Total revenue for the order, calculated as the sum of (quantity * unit_price) for all items in the order."
  - name: customer_name
    depends_on: ["src.customers.customer_name"]  # Joined from customers table
  - name: customer_segment
    depends_on: ["src.customers.customer_segment"]  # Customer segmentation info

