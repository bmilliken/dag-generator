group: mart
table: customer_lifetime_value
columns:
  - name: customer_id
    depends_on: [int.customer_metrics.customer_id]
  - name: customer_email
    depends_on: [int.customer_metrics.customer_email]
  - name: customer_tenure_days
    depends_on: [int.customer_metrics.first_order_date, int.customer_metrics.last_order_date]
  - name: total_orders
    depends_on: [int.customer_metrics.total_orders]
  - name: total_lifetime_value
    depends_on: [int.customer_metrics.total_spent]
  - name: avg_order_value
    depends_on: [int.customer_metrics.total_spent, int.customer_metrics.total_orders]
  - name: customer_segment
    depends_on: [int.customer_metrics.total_spent, int.customer_metrics.total_orders]
